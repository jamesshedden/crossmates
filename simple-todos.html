<head>
  <title>Crossmates</title>
</head>

<body>
  {{> imageView}}

  <div class="container">
    {{#if isAdmin}}
      {{#unless imageExists}}
        <form class="crossword-upload" action="">
          <input type="file" name="file" class="crossword-upload__input">
          <button type="submit">Upload</button>
        </form>
      {{/unless}}
    {{/if}}

    <header>
      {{> loginButtons}}

      {{#if currentUser}}
        <form class="new-task">

          <div class="new-task__input">
            <select name="direction" class="new-task__select" required>
              <option selected disabled="disabled">Direction</option>
              <option value="across">Across</option>
              <option value="down">Down</option>
            </select>
          </div>

          <input type="number" required
          name="number"
          class="new-task__input new-task__input--number"
          placeholder="Number">

          <input type="text" required
          class="new-task__input"
          name="text"
          placeholder="Word or phrase" />

          <input type="submit"
          class="new-task__submit">
        </form>
      {{/if}}
    </header>

    {{#each tasks}}
      {{> task}}
    {{/each}}
  </div>
</body>

<template name="task">
  <div class="task">
    <div class="task__suggestion">
      {{#if isAdmin}}
        <input type="checkbox"
        checked="{{checked}}"
        class="toggle-checked"/>
      {{/if}}

      <div class="task__suggestion-content" id="{{_id}}">
        <span class="task__suggestion-text {{#if checked}}task__suggestion-text--checked{{/if}}">
          <div class="clue" {{ clueFormatFilter text }}></div>

          &thinsp;&mdash;&thinsp;
          <strong>{{username}}</strong>
        </span>
      </div>

      <form class="suggestion-reply">
        <input type="text"
        name="reply"
        class="suggestion-reply__input"
        placeholder="Branch off this suggestion">
      </form>

      {{#if isAdmin}}
        <button class="delete">âœ”</button>
      {{/if}}
    </div>

    <div class="task__replies is-hidden">
      {{#each replies}}
        <div class="task__reply">
          <div class="task__reply-text">
            <strong>{{username}}</strong>&thinsp;&mdash;&thinsp;{{text}}
          </div>
        </div>
      {{/each}}
    </div>
  </div>
</template>

<template name="imageView">
  {{#each images}}
    <img src="{{this.url}}" alt="" class="thumbnail {{#if isAdmin}}can-remove{{/if}}">
  {{/each}}
</template>
